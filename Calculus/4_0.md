# 常微分方程
### 定义
#### 微分方程
含有==未知函数==的导数或微分的方程。

**阶数**：微分方程出现的未知函数的最高阶导数的阶数。

**解**：满足微分方程的函数。

**通解**：含有任意常数，且==任意常数的个数与方程阶数相同==的解。

**特解**：不含任意常数的解。

**初始条件**：确定特解的一组常数。

**积分曲线**：微分方程的解在平面上对应的一条曲线。
***
#### 一阶微分方程
##### 可分离变量的方程
能表示为：
$$
g(y)\mathrm{d}y=f(x)\mathrm{d}x\quad或\quad y'=g(y)f(x)
$$
的方程。
***
求解方法：对两端不定积分。
$$
\int g(y)\mathrm{d}y=\int f(x)\mathrm{d}x
$$
> 有些非可分离变量的方程，若等式两边的==原函数容易看出==，也可直接两端积分。
***
##### 齐次方程
能表示为：
$$
\frac{\mathrm{d}y}{\mathrm{d}x}=\varphi(\frac{y}{x})
$$
的方程。
***
求解方法：
1. 令 $\displaystyle u=\frac{y}{x}\Rightarrow y'=u+xu'$。
2. 代入 $y'$，使方程变形为可分离变量的方程：$xu'=\varphi(u)-u$。
> 注意：若变量代换后，得到可分离变量的方程需要==除以含u的式子==，可能丢失解。
> （即通解中不含初始条件决定的特解）
***
##### 线性方程
形如：
$$
y'+p(x)y=Q(x)
$$
的方程。
***
求解方法：
1. 常数变易。
2. 通解公式：
$$
y=e^{-\int p(x)\mathrm{d}x}\left [\int Q(x)\cdot e^{\int p(x)\mathrm{d}x}\mathrm{d}x+C\right ]
$$
> 注意：==只有在此处==，求 $\int p(x)dx$时，若 $p(x)=\frac{1}{x}$，则 $\int p(x)\mathrm{d}x=\ln x$，而不用写 $\ln \left\vert x \right\vert $，其他地方的 $\frac{1}{x}$的不定积分都带绝对值。
***
##### 伯努利方程
形如：
$$
y'+p(x)y=Q(x)y^n
$$
的方程。其中 $n\neq 0,1$。
***
求解方法：
1. 将 $y^{n}$除到等式左边。
2. 令 $u=y^{1-n}$，转为求解线性方程。
***
##### 全微分方程
若方程：
$$
P(x,y)\mathrm{d}x+Q(x,y)\mathrm{d}y=0
$$
的左端是某个函数 $u(x,y)$的**全微分**：
$$
\mathrm{d}u(x,y)=P(x,y)\mathrm{d}x+Q(x,y)\mathrm{d}y
$$
则该方程为全微分方程。
***
求解方法：
1. 找出 $u(x,y)$。
   * 偏积分
   * 凑微分
   * 线积分
2. 写出通解：$u(x,y)=C$。
   > u的全微分=0 $\Rightarrow$ u为常数。
***
> 若题目的一阶方程不属于以上五种形式，则考虑==将x视为y的函数==，或==变量代换==。
#### 可降阶的高阶微分方程
1. $y^{(n)}=x$
   > 不含x，y

   求解方法：积分n次。
2. $y''=f(x,y')$
   > 不含y

   求解方法：令 $y'=p,y''=p'$，转为一阶方程。
3. $y''=f(y,y')$
   > 不含x

   求解方法：令 $y'=p,y''=p\displaystyle \frac{\mathrm{d}p}{\mathrm{d}y}$，转为一阶方程。
   > 将 $y''$表示为复合形式：先p对y求导，再乘y对x求导。
***
#### 高阶线性微分方程
==二阶线性==微分方程的一般形式；
$$
y''+p(x)y'+q(x)y=f(x)
$$
其中，$p(x),q(x),f(x)$均为连续函数。

**二阶线性齐次方程**：$f(x)\equiv 0$。
一般形式：
$$
y''+p(x)y'+q(x)y=0
$$
> 若要求解==非常系数==的二阶方程，也可考虑将x视为y的函数。
***
##### 常系数齐次线性微分方程
==二阶常系数齐次线性==微分方程的一般形式：
$$
y''+py'+qy=0
$$
特征方程：
$$
r^{2}+pr+q=0
$$
可根据特征方程根的情况判断二阶常系数齐次线性微分方程的通解。
***
设 $r_1,r_2$为特征方程的根。
* 若 $r_1\neq r_2$（特征方程有两个不相等实根）
  常系数齐次方程的通解：
  $$
  y=C_1e^{r_1x}+C_2e^{r_2x}
  $$
  > 其中，$e^{r_1x},e^{r_2x}$即该齐次方程的两个线性无关特解。
* 若 $r_1=r_2$（特征方程有二重实根）
  常系数齐次方程的通解：
  $$
  y=(C_1+C_2x)e^{rx}
  $$
  > 其中，$e^{rx},xe^{rx}$即该齐次方程的两个线性无关特解。
* 若 $r_1=\alpha+i\beta,r_2=\alpha-i\beta$（特征方程有共轭复根）
  常系数齐次方程的通解：
  $$
  y=e^{\alpha x}(C_1\cos \beta x+C_2 \sin \beta x)
  $$
  > 其中，$e^{\alpha x}\cos \beta x,e^{\alpha x}\sin \beta x$即该齐次方程的两个线性无关特解。
***
对于更高阶的常系数齐次方程的通解：
1. 写出特征方程
2. 判断每个特征根的情况（n重根，共轭复根）
3. 将所有特征根产生的解加起来。
***
##### 常系数非齐次线性微分方程
==二阶常系数非齐次线性==微分方程的一般形式：
$$
y''+py'+qy=f(x)
$$
***
常系数非齐次方程==某个特解==的形式：
* $f(x)=P_m(x)e^{\lambda x}$ 
  _
  其中，$P_m(x)$为x的m次多项式。

  则常系数非齐次方程的某个特解为：
  $$
  y^{*}=x^{k}Q_m(x)e^{\lambda x}
  $$
  其中，
  * $Q_m(x)$—— $P_m(x)$的==同阶多项式的一般形式==。
  （例如：$Q_2(x)=ax^{2}+bx+c,Q_1(x)=ax+b,Q_0(x)=b$）
  * k——其==对应齐次方程==的==特征方程含根 $\lambda$的重复次数==。
  （例如：$r_1,r_2\neq \lambda\to k=0$，$r_1或r_2=\lambda\to k=1$，$r_1=r_2=\lambda\to k=2$）
/
* $f(x)=e^{\alpha x}[P_l(x)\cos \beta x+P_n(x)\sin \beta x]$ 
  _
  其中，$P_l(x),P_n(x)$为x的l,n次多项式。

  则常系数非齐次方程的某个特解为：
  $$
  y^{*}=x^{k}e^{\alpha x}[R_m^{(1)}(x)\cos \beta x+R_m^{(2)}(x)\sin \beta x]
  $$
  其中，
  * $R_m^{(1)}(x),R_m^{(2)}(x)$为 两个==m阶多项式的一般形式==。$m=\max \{k,l\}$。
  
  * $\alpha+i\beta$==不为其对应的齐次方程的特征根== $\Rightarrow k=0$。
  * $\alpha+i\beta$==为其对应的齐次方程的特征根== $\Rightarrow k=1$。
***
##### 欧拉方程
形如：
$$
x^{n}y^{(n)}+p_1x^{n-1}y^{n-1}+\cdots+p_{n-1}xy'+p_ny=f(x)
$$
其中，$p_1,p_2\cdots p_n$为常数。
的方程为欧拉方程。
> 可找出欧拉方程的函数：$y=ax^{n}$。
***
求解方法：令 $x=e^{t}$或 $t=\ln x$。
可将欧拉方程转为==常系数==方程，==每项为==：
$$
x^{k}y^{(k)}=D(D-1)\cdots (D-k+1)y
$$
其中，==D表示对t的求导==。
> 转换后的特征方程：第k项 $=r(r-1)\cdots (r-k+1)$
***
### 定理
#### 全微分方程的充要条件
若 $P(x,y),Q(x,y)$在单连通域 $G$内具有一阶连续偏导数。
则方程：
$$
P(x,y)\mathrm{d}x+Q(x,y)\mathrm{d}y=0
$$
是全微分方程 $\Leftrightarrow \displaystyle \frac{\partial P}{\partial y}=\frac{\partial Q}{\partial x}$。
***
#### 线性微分方程解的结构
* $y_1(x),y_2(x)$为齐次方程的两个线性无关特解 
  $\Rightarrow y=C_1y_1(x)+C_2y_2(x)$为该齐次方程的通解。
  > 两个线性无关的特解的线性组合=通解。
* $y^*(x)$是非齐次线性方程的特解，$y_1(x),y_2(x)$是对应齐次方程的两个线性无关特解 
  $\Rightarrow y=C_1y_1(x)+C_2y_2(x)+y^*(x)$是该非齐次方程的通解。
  > 齐次通解+非齐次特解=非齐次通解
* $y_1^{*}(x),y_2^{*}(x)$是非齐次方程的两个特解
  $\Rightarrow y(x)=y_2^{*}(x)-y_1^{*}(x)$是齐次方程的解。
  > 非齐次特解-非齐次特解=齐次特解
  > 非齐次特解-齐次特解=非齐次特解
* $y_1^{*}(x),y_2^{*}(x)$分别是==非齐次方程==：
  $$
  \begin{aligned}
    y''+p(x)y'+q(x)y=f_1(x) \\
    y''+p(x)y'+q(x)y=f_2(x)
  \end{aligned}
  $$
  的特解 $\Rightarrow y_1^{*}(x)+y_2^{*}(x)$是方程：
  $$
  y''+p(x)y'+q(x)y=f_1(x)+f_2(x)
  $$
  的一个特解。
***
判断线性无关：
$$
\frac{y_1(x)}{y_2(x)}\neq C
$$
两个解的商不恒等于常数。
***
### 方法
#### 已知方程的解，找方程
* 方程为常系数方程
  若已知非齐次特解，需==判断==齐次解和非齐次解，找==特征根==。
* 方程为一般线性方程
  若已知非齐次通解，则==对通解求一阶，二阶导==，然后对任意常数==消元==。
#### 函数方程求解
直接应用导数定义。
  